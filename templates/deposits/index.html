{% extends "base.html" %}
{% block title %}Deposits - Banking System{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2"><i class="fas fa-piggy-bank me-2"></i>Deposits</h1>
  <div class="btn-group">
    <a href="{{ url_for('fd_open') }}" class="btn btn-primary"><i class="fas fa-certificate me-2"></i>Open FD</a>
    <a href="{{ url_for('rd_open') }}" class="btn btn-outline-primary"><i class="fas fa-coins me-2"></i>Open RD</a>
  </div>
</div>
<div class="row g-3">
  <div class="col-md-6">
    <div class="card h-100"><div class="card-header"><strong><i class="fas fa-file-shield me-2"></i>Fixed Deposits (FD)</strong></div>
    <div class="card-body">
      {% if fds %}
      <div class="table-responsive">
        <table class="table table-striped">
          <thead><tr>
            <th>Acct</th><th>Name</th><th>Amount</th><th>Rate</th><th>Tenure</th><th>Maturity</th><th>Status</th><th>Certificate</th>
          </tr></thead>
          <tbody>
            {% for d in fds %}
            <tr>
              <td>{{ d.customer_id }}</td>
              <td>{{ d.full_name }}</td>
              <td>₹{{ "{:,.2f}".format(d.deposit_amount) }}</td>
              <td>{{ d.interest_rate }}%</td>
              <td>{{ d.tenure_months }} mo</td>
              <td>{{ d.maturity_date }}</td>
              <td>
                <span class="badge bg-{% if d.fd_status=='active' %}success{% elif d.fd_status=='matured' %}warning{% else %}secondary{% endif %}">{{ d.fd_status }}</span>
                {% if d.renew_due %}<span class="badge bg-info ms-1">Renewal Due</span>{% endif %}
              </td>
              <td>
                <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('cert_fd_open', fd_id=d.id) }}"><i class="fas fa-file-pdf me-1"></i>PDF</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <p class="text-muted mb-0">No FDs found.</p>
      {% endif %}
    </div></div>
  </div>
  <div class="col-md-6">
    <div class="card h-100"><div class="card-header"><strong><i class="fas fa-sack-dollar me-2"></i>Recurring Deposits (RD)</strong></div>
    <div class="card-body">
      {% if rds %}
      <div class="table-responsive">
        <table class="table table-striped">
          <thead><tr>
            <th>Acct</th><th>Name</th><th>Monthly</th><th>Rate</th><th>Tenure</th><th>Maturity</th><th>Status</th><th>Certificate</th>
          </tr></thead>
          <tbody>
            {% for r in rds %}
            <tr>
              <td>{{ r.customer_id }}</td>
              <td>{{ r.full_name }}</td>
              <td>₹{{ "{:,.2f}".format(r.monthly_amount) }}</td>
              <td>{{ r.interest_rate }}%</td>
              <td>{{ r.tenure_months }} mo</td>
              <td>{{ r.maturity_date }}</td>
              <td>
                <span class="badge bg-{% if r.rd_status=='active' %}success{% elif r.rd_status=='completed' %}primary{% else %}secondary{% endif %}">{{ r.rd_status }}</span>
                {% if r.overdue %}<span class="badge bg-danger ms-1">Overdue</span>{% endif %}
              </td>
              <td>
                <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('cert_rd_open', rd_id=r.id) }}"><i class="fas fa-file-pdf me-1"></i>PDF</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <p class="text-muted mb-0">No RDs found.</p>
      {% endif %}
    </div></div>
  </div>
</div>
{% endblock %}